# 0. 学习资源

图见[仓库](https://github.com/RS-HIT/RS-HIT.github.io.git "RS的学习笔记")

## 0.1 视频链接

[B 站课程](https://www.bilibili.com/video/BV1oa4y1v7TY/?spm_id_from=333.337.search-card.all.click&vd_source=7aa431eece1d1c0d38afe62a0e6d152f)

# 1. 刚体运动的描述

## 1.1 描述一个刚体的状态

- 平面
  在平面上需要**3**个参数描述其**2**个移动自由度和**1**个转动自由度
- 空间
  在空间中需要**6**个参数描述其**3**个移动自由度和**3**个转动自由度

## 1.2 整合表达刚体的状态

在刚体的质心处建立坐标系, 以量化描述刚体的移动和转动. 通过微分求解速度与加速度

## 1.3 移动的描述

以向量(vector) $\vec{P}$ 来描述 $\{B\}$ 的原点相对于 $\{A\}$ 的状态

![图1-1](0907_001.png "图1-1")

$$
\vec{P}=
\left[
    \begin{matrix}
    P_x \\
    P_y \\
    P_z
\end{matrix}
\right]=
^{A}P_{Borg}=origin{\quad}of{\quad}\{B\}{\quad}represented{\quad}in{\quad}\{A\}
$$

## 1.4 转动的描述

旋转矩阵来描述 $\{B\}$ 的原点相对于 $\{A\}$ 的姿态
投影, 内积

$$
{}_{B}^{A}R= \left[ \begin{matrix}|&|&|\\ {}^{A} \hat{X}_{B}&{}^{A} \hat{Y}_{B}&{}^{A} \hat{Z}_{B} \\ |&|&|\end{matrix} \right]=
\left[ \begin{matrix} \hat{X}_{B} \cdot \hat{X}_{A}& \hat{Y}_{B} \cdot \hat{X}_{A}& \hat{Z}_{B} \cdot \hat{X}_{A} \\ \hat{X}_{B} \cdot \hat{Y}_{A}& \hat{Y}_{B} \cdot \hat{Y}_{A}& \hat{Z}_{B} \cdot \hat{Y}_{A} \\ \hat{X}_{B} \cdot \hat{Z}_{A}& \hat{Y}_{B} \cdot \hat{Z}_{A}& \hat{Z}_{B} \cdot \hat{Z}_{A} \end{matrix} \right]
$$

**例 1:**

![图1-2](0907_002.png "图1-2")
图中蓝色虚线为 $\{A\}$ 坐标系, 红色实线为 $\{B\}$坐标系, 则:

$\{B\}$ 的 $x''$ 轴为 $\{A\}$ 的 $z$轴 反向 $\Rightarrow{}^{A} \hat{X}_{B}= \left[ \begin{matrix} 0 \\ 0 \\ -1 \end{matrix} \right]$

$\{B\}$ 的 $y''$ 轴为 $\{A\}$ 的 $y$轴 重叠 $\Rightarrow{}^{A} \hat{Y}_{B}= \left[ \begin{matrix} 0 \\ 1 \\ 0 \end{matrix} \right]$

$\{B\}$ 的 $z''$ 轴为 $\{A\}$ 的 $x$轴 重叠 $\Rightarrow{}^{A} \hat{Z}_{B}= \left[ \begin{matrix} 1 \\ 0 \\ 0 \end{matrix} \right]$

因此, $\{B\}$ 的原点相对于 $\{A\}$ 的姿态:

$$
{}_{B}^{A}R= \left[ \begin{matrix}|&|&|\\ {}^{A} \hat{X}_{B}&{}^{A} \hat{Y}_{B}&{}^{A} \hat{Z}_{B} \\ |&|&|\end{matrix} \right]=
\left[
    \begin{matrix}
    0 & 0 & 1 \\
    0 & 1 & 0 \\
    -1 & 0 & 0
\end{matrix}
\right]
$$

**例 2:**
红色往蓝色上投影!
![图1-3](0907_003.png "图1-3")
图中蓝色虚线为 $\{A\}$ 坐标系, 红色实线为 $\{B\}$坐标系, 则:

$$
{}^{A}\hat{X}_{B}=
\left[\begin{matrix}
\hat{X}_{B} \cdot \hat{X}_{A} \\
\hat{X}_{B} \cdot \hat{Y}_{A} \\
\hat{X}_{B} \cdot \hat{Z}_{A}
\end{matrix}\right]=
\left[\begin{matrix}
{\frac {\sqrt 3}{2}} \\[1.0ex]
{\frac{1}{2}} \\[1.0ex]
0
\end{matrix} \right]
$$

$$
{}^{A}\hat{Y}_{B}=
\left[\begin{matrix}
\hat{Y}_{B} \cdot \hat{X}_{A} \\
\hat{Y}_{B} \cdot \hat{Y}_{A} \\
\hat{Y}_{B} \cdot \hat{Z}_{A} \end{matrix} \right]=
\left[\begin{matrix}
{-\frac{1}{2}} \\[1.0ex]
{\frac {\sqrt 3}{2}} \\[1.0ex]
0
\end{matrix} \right]
$$

$$
{}^{A}\hat{Z}_{B}= \left[ \begin{matrix} \hat{Z}_{B} \cdot \hat{X}_{A} \\ \hat{Z}_{B} \cdot \hat{Y}_{A} \\ \hat{Z}_{B} \cdot \hat{Z}_{A} \end{matrix} \right]= \left[ \begin{matrix} 0 \\ 0 \\ 1 \end{matrix} \right]
$$

则 $\{B\}$ 相对于 $\{A\}$ 的姿态:

$$
{}^{A}_{B}R=
\left[\begin{matrix}
{\frac {\sqrt 3}{2}} & -{\frac{1}{2}} & 0 \\[1.0ex]
{\frac{1}{2}} & {\frac {\sqrt 3}{2}} & 0 \\[1.0ex]
0 & 0 & 1
\end{matrix}\right]
$$

## 1.5 旋转矩阵的特性

### 1.5.1 特性 1

由于内积无顺序性, 将向量互换, 则可得到

$$
{}_{B}^{A}R= \begin{bmatrix}\hat{X}_{B}\cdot\hat{X}_{A}&\hat{Y}_{B} \cdot\hat{X}_{A}&\hat{Z}_{B}\cdot\hat{X}_{A}\\ \hat{X}_{B}\cdot\hat{Y}_{A}&\hat{Y}_{B}\cdot\hat{Y}_{A}& \hat{Z}_{B}\cdot\hat{Y}_{A}\\ \hat{X}_{B}\cdot\hat{Z}_{A}&\hat{Y}_{B}\cdot\hat{Z}_{A}& \hat{Z}_{B}\cdot\hat{Z}_{A}\end{bmatrix}= \begin{bmatrix}|&|&|\\ {}^{A}\hat{X}_{B}&{}^{A}\hat{Y}_{B}&{}^{A}\hat{Z}_{B}\\ |&|&|\end{bmatrix}
$$

$$
=\begin{bmatrix}\hat{X}_{A}\cdot\hat{X}_{B}& \hat{X}_{A}\cdot\hat{Y}_{B}&\hat{X}_{A}\cdot\hat{Z}_{B}\\ \hat{Y}_{A}\cdot\hat{X}_{B}&\hat{Y}_{A}\cdot\hat{Y}_{B}& \hat{Y}_{A}\cdot\hat{Z}_{B}\\ \hat{Z}_{A}\cdot\hat{X}_{B}&\hat{Z}_{A}\cdot\hat{Y}_{B}& \hat{Z}_{A}\cdot\hat{Z}_{B}\end{bmatrix}=\begin{bmatrix}-&{}^{B} \hat{X}_{A}{}^{T}&-\\ -&{}^{B}\hat{Y}_{A}{}^{T}&-\\ -&{}^{B}\hat{Z}_{A}{}^{T}&-\end{bmatrix}
$$

$$
= \begin{bmatrix}|&|&|\\ {}^{B}\hat{X}_{A}&{}^{B}\hat{Y}_{A}&{}^{B}\hat{Z}_{A}\\ |&|&|\end{bmatrix}^{T}={}_{A}^{B}R^{T}
$$

即 $\{B\}$ 相对于 $\{A\}$ 的姿态矩阵等于 $\{A\}$ 相对于 $\{B\}$ 的姿态矩阵的转置

### 1.5.2 特性 2

$$
{}^{A}_{B}R^{T} {}^{A}_{B}R=\begin{bmatrix}|&|&|\\ {}^{A}\hat{X}_{B}&{}^{A}\hat{Y}_{B}&{}^{A}\hat{Z}_{B}\\ |&|&|\end{bmatrix}^{T}\begin{bmatrix}|&|&|\\ {}^{A}\hat{X}_{B}&{}^{A}\hat{Y}_{B}&{}^{A}\hat{Z}_{B}\\ |&|&|\end{bmatrix}
$$

$$
= \left[ \begin{matrix}-&{}^{A} \hat{X}_{B}{}^{T}&- \\ -&{}^{A} \hat{Y}_{B}{}^{T}&- \\ -&{}^{A} \hat{Z}_{B}{}^{T}&- \end{matrix} \right] \left[ \begin{matrix}|&|&|\\ {}^{A} \hat{X}_{B}&{}^{A} \hat{Y}_{B}&{}^{A} \hat{Z}_{B} \\ |&|&|\end{matrix} \right]
=\left[\begin{matrix}1&0&0 \\ 0&1&0 \\ 0&0&1\end{matrix}\right]
$$

$$
\Rightarrow {}^{A}_{B}R^{T} {}^{A}_{B}R=I_3={}^{A}_{B}R^{-1} {}^{A}_{B}R
$$

$$
\Rightarrow {}^{A}_{B}R^{T}={}^{A}_{B}R^{-1}={}^{B}_{A}R
$$

即位姿矩阵的转置等于其逆矩阵, 即该矩阵为正交矩阵.

### 1.5.3 特性 3

正交矩阵每一列都是长度为 1 的单位向量且彼此垂直, 故虽然 3\*3 的矩阵有 9 个元素, 但正交性条件带来了三个约束, 故剩下 3 个自由度刚好对应了三维空间中的旋转.

## 1.6 关于旋转矩阵的表达与作用

假设 $\{B\}$ 相对于 $\{A\}$ 绕 $\hat{Z}_{A}$ 轴沿正方向旋转 $\theta$ 角度
旋转方向右手定则为正

![图1-4](0907_004.png "图1-4")

$$
R_{ \hat{Z}_{A}} \left( \theta \right)= \left[ \begin{matrix} \cos \theta & -\sin \theta&0 \\ \sin \theta& \cos \theta&0 \\ 0&0&1 \end{matrix} \right]
$$

一般简写为

$$
R_{ \hat{Z}_{A}} \left( \theta \right)= \left[ \begin{matrix} c \theta & -s \theta & 0 \\ s \theta& c \theta & 0 \\ 0&0&1 \end{matrix} \right]
$$

同理可得绕$\hat{X}_{A}$轴旋转:

$$
R_{ \hat{X}_{A}} \left( \theta \right)=
\left[ \begin{matrix} 1&0&0 \\ 0&c \theta&-s \theta \\ 0&s \theta&c \theta \end{matrix} \right]
$$

绕$\hat{Y}_{A}$轴旋转:

$$
R_{ \hat{Y}_{A}} \left( \theta \right)=
\left[ \begin{matrix} c \theta&0&s \theta \\ 0&1&0 \\ -s \theta&0&c \theta \end{matrix} \right]
$$

例:
${}^{A}P=\left[ \begin{matrix} 0 \\ 1 \\ \frac{\sqrt{3}}{2} \end{matrix} \right]$ 对 $\hat{X}_{A}$ 轴旋转30°, 则 ${}^{A}P'=?$
解:
$$
R_{ \hat{X}_{A}} \left( \theta \right)=
\left[ \begin{matrix} 1&0&0 \\ 0&c \theta&-s \theta \\ 0&s \theta&c \theta \end{matrix} \right]
$$
$$
{}^{A}P'=R_{\hat{X}_{A}}(\theta) {}^{A}P
=\left[\begin{matrix} 0\\0\\2 \end{matrix} \right]
$$

### 1.7 总结: 旋转矩阵的三种用法

- 描述一个坐标轴相对于另一个坐标轴的姿态

$$
{}_{B}^{A}R= \left[ \begin{matrix}|&|&|\\ {}^{A} \hat{X}_{B}&{}^{A} \hat{Y}_{B}&{}^{A} \hat{Z}_{B} \\ |&|&|\end{matrix} \right]
$$

- 将向量由某一个坐标轴的表达换到另一个和此坐标轴仅有相对转动的坐标轴来表达

$$
{}^{A}P={}^{A}_{B}R{}^{B}P
$$

- 将向量在同一个坐标系中进行转动

$$
{}^{A}P'=R(\theta)^{A}P
$$

## 1.8 旋转矩阵的拆解

将一般旋转矩阵表达的姿态拆解成3次旋转角度
**注意事项:**

- 旋转具有顺序性, 多次旋转的先后顺序需要明确定义
- 旋转转轴也需要明确定义, 是对某固定的轴旋转或是对转动的坐标系当下所在的转轴旋转?

于是介绍两种拆解方式

### 1.8.1 针对固定转轴的转动

三个矩阵的连乘, 先转的放在后面, 旋转矩阵应当左乘.

假如首先针对 $\{X\}$ 轴转动 $\gamma$ 度, 然后针对 $\{Y\}$ 轴转动 $\beta$ 度, 最后针对 $\{Z\}$ 轴转动 $\alpha$ 度, 则有

$$
{}_{B}^{A}R_{XYZ} \left( \gamma, \beta, \alpha \right)=R_{Z} \left( \alpha \right) R_{Y} \left( \beta \right) R_{X} \left( \gamma \right)
$$
$$
=\begin{bmatrix}c\alpha&-s\alpha&0\\ s\alpha&c\alpha&0\\ 0&0&1\end{bmatrix}\begin{bmatrix}c\beta&0&s\beta\\ 0&1&0\\ -s\beta&0&c\beta\end{bmatrix}\begin{bmatrix}1&0&0\\ 0&c\gamma&-s\gamma\\ 0&s\gamma&c\gamma\end{bmatrix}
$$
$$
= \left[ \begin{matrix} c \alpha c \beta&c \alpha s \beta s \gamma-s \alpha c \gamma&c \alpha s \beta c \gamma+s \alpha s \gamma \\ s \alpha c \beta&s \alpha s \beta s \gamma+c \alpha c \gamma&s \alpha s \beta c \gamma-c \alpha s \gamma \\ -s \beta&c \beta s \gamma&c \beta c \gamma \end{matrix} \right]
$$

### 1.8.2 由旋转矩阵反解各轴旋转角度

$$
{}^{A}_{B}R_{_{XYZ}}(\gamma,\beta,\alpha)=
\begin{bmatrix}
c\alpha c\beta&c \alpha s\beta s\gamma-s\alpha c\gamma&c\alpha s\beta c\gamma+s\alpha s\gamma \\
s\alpha c\beta&s\alpha s\beta s\gamma+c\alpha c\gamma&s\alpha s\beta c\gamma-c \alpha s\gamma\\
-s\beta&c\beta s\gamma&c\beta c\gamma
\end{bmatrix}=
\begin{bmatrix}
r_{11}&r_{12 }&r_{13}\\ 
r_{21}&r_{22}&r_{23}\\ r_{31}&r_{32}&r_{33}\end{bmatrix}
$$

1. 假设中间角度 $\beta \neq 90 ^{\circ}$ (若等于则解不唯一)
   $$
   \begin{split}\beta&=Atan2 \left(-r_{31}, \sqrt{r_{11}^{2}+r_{21}^{2}} \right) \\ \alpha&=Atan2 \left( r_{21}/c \beta,r_{11}/c \beta \right) \\ \gamma&=Atan2 \left( r_{32}/c \beta,r_{33}/c \beta \right) \end{split}
   $$

   PS: $Atan2$ 为反正切函数, 且 $\alpha$ 在 $\left[ -\pi, \pi \right]$ 范围内

1. 若中间角度 $\beta = 90 ^{\circ}$
   则 $\alpha=0$ , $\gamma=Atan2(r_{12},r_{22})$
1. 若中间角度 $\beta = -90 ^{\circ}$
   则 $\alpha=0$ , $\gamma=-Atan2(r_{12},r_{22})$

### 1.8.3 针对转动转轴的旋转

先转的放在前面, 后转的放在后面, 旋转矩阵应当右乘.

$$
{}_{B}^{A}R_{Z^{\prime}Y^{\prime}X^{\prime}}(\alpha,\beta,\gamma)={}_{B^{\prime}}^{A}R_{B^{\prime\prime}}^{B^{\prime}}R{}_{B}^{B^{\prime\prime}}R=R_{Z^{\prime}}(\alpha)R_{Y^{\prime}}(\beta)R_{X^{\prime}}(\gamma)
$$

$$=
\begin{bmatrix}
c\alpha & -s\alpha & 0 \\
s\alpha & c\alpha & 0 \\
0 & 0 & 1
\end{bmatrix}
\begin{bmatrix}
c\beta & 0 & s\beta \\
0 & 1 & 0 \\
-s\beta & 0 & c\beta
\end{bmatrix}
\begin{bmatrix}
1 & 0 & 0 \\
0 & c\gamma & -s\gamma \\
0 & s\gamma & c\gamma
\end{bmatrix}
$$

$$
=R_{Z}(\alpha)R_{Y}(\beta)R_{X}(\gamma)={}_{B}^{A}R_{XYZ}(\gamma,\beta,\alpha)
$$

即: 针对转动转轴(Euler Angles)的旋转恰好是针对固定转轴(Fix Angles)的反序旋转.

### 1.8.4 由旋转矩阵反解各轴旋转角度

$$
{}^{A}_{B}R_{z^{^{\prime}}y^{^{\prime}}z^{^{\prime}}}(\alpha,\beta, \gamma)=\begin{bmatrix}
c\alpha c\beta c\gamma -s\alpha s\gamma&-c\alpha c \beta s\gamma -s\alpha c\gamma&c\alpha s\beta\\
s\alpha c\beta c\gamma +c\alpha s\gamma&-s\alpha c\beta s\gamma+c\alpha c \gamma&s\alpha s\beta\\
-s\beta c\gamma&s\beta s\gamma&c\beta\end{bmatrix}=\begin{bmatrix}r_{11}&r_{12 }&r_{13}\\
r_{21}&r_{22}&r_{23}\\
r_{31}&r_{32}&r_{33}
\end{bmatrix}
$$

1. 假设中间角度$\beta \neq 0 ^{\circ}$, 则有
   $\beta=Atan2(\sqrt{r_{31}^{2}+r_{32}^{2}},r_{33})$
   $\alpha=Atan2(r_{23}/s\beta,r_{13}/s\beta)$
   $\gamma=Atan2(r_{32}/s\beta,-r_{31}/s\beta)$

1. 若中间角度 $\beta = 0 ^{\circ}$
   $\alpha = 0$ , $\gamma=Atan2(-r_{12},r_{11})$

1. 若中间角度 $\beta = 180 ^{\circ}$
   $\alpha = 0$ , $\gamma=Atan2(r_{12},-r_{11})$

